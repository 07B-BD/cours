import{_ as i,o as a,c as e,ag as n}from"./chunks/framework.CpVu2XTb.js";const t="/cours/assets/voir-contraintes.B3aRJxzc.png",l="/cours/assets/enum1.CIgTv_w4.png",r="/cours/assets/enum2.ud5oVE8n.png",g=JSON.parse('{"title":"03 — Contraintes","description":"","frontmatter":{"title":"03 — Contraintes","aside":false},"headers":[],"relativePath":"modules/02-ddl-base/03-contraintes-simples.md","filePath":"modules/02-ddl-base/03-contraintes-simples.md"}'),h={name:"modules/02-ddl-base/03-contraintes-simples.md"};function p(o,s,k,d,c,u){return a(),e("div",null,[...s[0]||(s[0]=[n(`<h1 id="_03-—-contraintes-et-enums" tabindex="-1">03 — Contraintes et Enums <a class="header-anchor" href="#_03-—-contraintes-et-enums" aria-label="Permalink to &quot;03 — Contraintes et Enums&quot;">​</a></h1><h2 id="objectif" tabindex="-1">Objectif <a class="header-anchor" href="#objectif" aria-label="Permalink to &quot;Objectif&quot;">​</a></h2><p>Comprendre comment utiliser des <strong>contraintes</strong> pour assurer l’<strong>intégrité minimale des données</strong> dès la définition de la structure d’une table.</p><div class="my-6 rounded-lg border border-blue-300 bg-blue-50 p-4 text-blue-900">Les contraintes permettent d’empêcher certaines erreurs <span class="font-bold">avant même l’insertion de données</span>.</div><hr><h2 id="pourquoi-utiliser-des-contraintes" tabindex="-1">Pourquoi utiliser des contraintes ? <a class="header-anchor" href="#pourquoi-utiliser-des-contraintes" aria-label="Permalink to &quot;Pourquoi utiliser des contraintes ?&quot;">​</a></h2><p>Sans contraintes, une base de données peut accepter :</p><ul><li>des valeurs manquantes</li><li>des doublons lorsqu&#39;ils ne devraient pas être permis (ex.: courriel)</li><li>des valeurs incohérentes (ex.: date dans le passé qui ne devrait pas l&#39;être)</li></ul><p>Les contraintes permettent donc :</p><ul><li>de <strong>forcer des règles</strong> sur les données</li><li>de protéger la cohérence et la qualité des données</li></ul><hr><h2 id="types-de-contraintes-abordees" tabindex="-1">Types de contraintes abordées <a class="header-anchor" href="#types-de-contraintes-abordees" aria-label="Permalink to &quot;Types de contraintes abordées&quot;">​</a></h2><p>Dans cette section, nous verrons :</p><ul><li>NOT NULL / NULL</li><li>UNIQUE</li><li>DEFAULT</li><li>CHECK</li></ul><div class="my-6 rounded-lg border border-blue-300 bg-blue-50 p-4 text-blue-900">Les clés primaires et étrangères seront vues dans la section suivante..</div><hr><h2 id="contrainte-not-null" tabindex="-1">Contrainte NOT NULL <a class="header-anchor" href="#contrainte-not-null" aria-label="Permalink to &quot;Contrainte NOT NULL&quot;">​</a></h2><h3 id="role" tabindex="-1">Rôle <a class="header-anchor" href="#role" aria-label="Permalink to &quot;Rôle&quot;">​</a></h3><ul><li>Empêche une colonne de contenir une valeur nulle (NULL).</li><li>Dans le sens inverse, il n&#39;est pas nécessaire d&#39;indiquer <code>NULL</code> sur une colonne nullable.</li><li>C&#39;est la contrainte la plus couramment utilisée.</li></ul><h3 id="exemple" tabindex="-1">Exemple <a class="header-anchor" href="#exemple" aria-label="Permalink to &quot;Exemple&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> evenement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">not null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        date_evenement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    );</span></span></code></pre></div><blockquote><p>Ici, un événement doit obligatoirement avoir un nom et une date.</p></blockquote><hr><h2 id="contrainte-unique" tabindex="-1">Contrainte UNIQUE <a class="header-anchor" href="#contrainte-unique" aria-label="Permalink to &quot;Contrainte UNIQUE&quot;">​</a></h2><h3 id="role-1" tabindex="-1">Rôle <a class="header-anchor" href="#role-1" aria-label="Permalink to &quot;Rôle&quot;">​</a></h3><p>Empêche la présence de <strong>doublons</strong> dans une colonne.</p><h3 id="exemple-1" tabindex="-1">Exemple <a class="header-anchor" href="#exemple-1" aria-label="Permalink to &quot;Exemple&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> participant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        courriel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">unique</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    );</span></span></code></pre></div><blockquote><p>Deux participants ne peuvent pas avoir le même courriel.</p></blockquote><hr><h2 id="contrainte-default" tabindex="-1">Contrainte DEFAULT <a class="header-anchor" href="#contrainte-default" aria-label="Permalink to &quot;Contrainte DEFAULT&quot;">​</a></h2><h3 id="role-2" tabindex="-1">Rôle <a class="header-anchor" href="#role-2" aria-label="Permalink to &quot;Rôle&quot;">​</a></h3><p>Attribue une <strong>valeur par défaut</strong> lorsqu’aucune valeur n’est fournie.</p><h3 id="exemple-2" tabindex="-1">Exemple <a class="header-anchor" href="#exemple-2" aria-label="Permalink to &quot;Exemple&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> evenement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">not null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        actif </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">boolean</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    );</span></span></code></pre></div><blockquote><p>Si aucune valeur n’est fournie pour la colonne <code>actif</code>, la valeur TRUE sera utilisée.</p></blockquote><hr><h2 id="contrainte-check" tabindex="-1">Contrainte CHECK <a class="header-anchor" href="#contrainte-check" aria-label="Permalink to &quot;Contrainte CHECK&quot;">​</a></h2><h3 id="role-3" tabindex="-1">Rôle <a class="header-anchor" href="#role-3" aria-label="Permalink to &quot;Rôle&quot;">​</a></h3><p>Impose une <strong>condition logique</strong> sur les valeurs possibles d’une colonne.</p><h3 id="exemple-3" tabindex="-1">Exemple <a class="header-anchor" href="#exemple-3" aria-label="Permalink to &quot;Exemple&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inscription</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        nombre_places </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">integer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> check</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nombre_places </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    );</span></span></code></pre></div><blockquote><p>Le nombre de places doit être supérieur à 0.</p></blockquote><hr><h2 id="combiner-plusieurs-contraintes" tabindex="-1">Combiner plusieurs contraintes <a class="header-anchor" href="#combiner-plusieurs-contraintes" aria-label="Permalink to &quot;Combiner plusieurs contraintes&quot;">​</a></h2><p>Une même colonne peut avoir <strong>plusieurs contraintes</strong>.</p><h3 id="exemple-4" tabindex="-1">Exemple <a class="header-anchor" href="#exemple-4" aria-label="Permalink to &quot;Exemple&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> evenement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">not null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    capacite </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">integer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> check</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (capacite </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    actif </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">boolean</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><blockquote><p>Les contraintes se complètent pour renforcer la qualité des données.</p></blockquote><hr><h2 id="erreurs-a-eviter" tabindex="-1">Erreurs à éviter <a class="header-anchor" href="#erreurs-a-eviter" aria-label="Permalink to &quot;Erreurs à éviter&quot;">​</a></h2><ul><li>Oublier NOT NULL sur une colonne obligatoire</li><li>Mettre UNIQUE sur une colonne qui peut légitimement se répéter</li><li>Utiliser des CHECK trop complexes</li><li>Croire que les contraintes remplacent toute validation applicative</li></ul><hr><h2 id="voir-les-contraintes-dans-dbeaver" tabindex="-1">Voir les contraintes dans DBeaver <a class="header-anchor" href="#voir-les-contraintes-dans-dbeaver" aria-label="Permalink to &quot;Voir les contraintes dans DBeaver&quot;">​</a></h2><img src="`+t+`" alt="Voir contraintes" class="img-bordered w-s"><blockquote><p>Ces informations permettent de <strong>valider rapidement</strong> que la structure de la table correspond bien aux règles définies lors de sa création.</p></blockquote><hr><h2 id="type-enum" tabindex="-1">Type ENUM <a class="header-anchor" href="#type-enum" aria-label="Permalink to &quot;Type ENUM&quot;">​</a></h2><h3 id="role-4" tabindex="-1">Rôle <a class="header-anchor" href="#role-4" aria-label="Permalink to &quot;Rôle&quot;">​</a></h3><p>Limiter les <strong>valeurs possibles</strong> d’une colonne à un <strong>ensemble prédéfini et fermé</strong>.</p><p>Une colonne de type <code>ENUM</code> n’accepte <strong>que les valeurs explicitement définies</strong> lors de la création du type.</p><blockquote><p>Un <code>ENUM</code> est un <strong>type de données et non une contrainte de table</strong>. Il permet toutefois d&#39;agir d&#39;une façon similaire à un <code>CHECK</code>.</p></blockquote><hr><h3 id="exemple-5" tabindex="-1">Exemple <a class="header-anchor" href="#exemple-5" aria-label="Permalink to &quot;Exemple&quot;">​</a></h3><ol><li>On doit en premier lieu créer un nouveau <code>TYPE AS ENUM</code>.</li><li>On peut ensuite utiliser le nouveau type à la création de table.</li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> statut_evenement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> enum (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;planifie&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;annule&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;termine&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> evenement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">not null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    statut statut_evenement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">not null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><blockquote><p>Ici, la colonne <code>statut</code> ne peut contenir que l’une des valeurs définies dans l’ENUM.</p></blockquote><hr><h3 id="visualisation-dans-dbeaver" tabindex="-1">Visualisation dans DBeaver <a class="header-anchor" href="#visualisation-dans-dbeaver" aria-label="Permalink to &quot;Visualisation dans DBeaver&quot;">​</a></h3><p>Les types <code>ENUM</code> sont visibles dans :</p><ul><li>le schéma de la base de données</li><li>la liste des <strong>Types</strong> ou <strong>Domains</strong></li><li>la définition de la colonne utilisant ce type</li></ul><img src="`+l+'" alt="Voir enums" class="img-bordered w-s mb-5"><img src="'+r+'" alt="Enum" class="img-bordered w-s">',73)])])}const m=i(h,[["render",p]]);export{g as __pageData,m as default};
